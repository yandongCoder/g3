<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../dist/css/graph.css">
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        .svg1 {
            width: 1500px;
            height: 500px;
            background: beige;
        }

        .tools {
            position: fixed;
            top: 10px;
            left: 10px;
        }
    </style>
</head>
<body>
<svg id="my-graph"></svg>
<div class="tools">
    <button id="showBrush">showBrush</button>
</div>
</body>
</html>
<script src="../node_modules/d3/build/d3.js"></script>
<script src="../node_modules/jquery/dist/jquery.min.js"></script>
<script src="../dist/js/g3.js"></script>
<script>

    var nodes = [{id: 1, label: "A", x: 0, y: 0, radius: 30, color: "#547895"}, {
        id: 2, label: "A", x: 100, y: 0, radius: 20
    },
        {id: 3, label: "C", x: 0, y: 100, radius: 30}, {id: 4, label: "D", x: 100, y: 100, radius: 20},
        {id: 5, label: "E", x: 0, y: 200, radius: 30}, {id: 6, label: "F", x: 100, y: 200, radius: 20},
        {id: 7, label: "X", x: 0, y: 300, radius: 30}, {id: 8, label: "Y", x: 100, y: 300, radius: 20}
    ];
    var links = [{id: 1, label: "A", src: 1, dst: 2, direction: 1, width: 5},
        {id: 2, label: "C", src: 1, dst: 3, direction: 2, width: 5},
        {id: 3, label: "EF1", src: 5, dst: 6, direction: 3, width: 5},
        {id: 4, label: "EF2", src: 6, dst: 5, direction: 3},
        {id: 5, label: "X", src: 7, dst: 8, direction: 0, width: 5, color: 'blue'}

    ];


    var myGraph = g3.graph("#my-graph")
            .nodes([{id: 1, label: "1", x: 100, y: 100}, {id: 2, label: "2", x: 250, y: 150}, {
                id: 3, label: "3", x: 240, y: 170
            }, {id: 4, label: "4", x: 400, y: 200}, {id: 5, label: "5", x: 400, y: 100}])
            .links([{id: 1, src: 1, dst: 2, direction: 0}, {id: 2, src: 1, dst: 3, direction: 1}, {
                id: 3, src: 2, dst: 4, direction: 2
            }, {id: 4, src: 2, dst: 5, direction: 3}, {id: 5, src: 3, dst: 4, direction: 3}, {id: 6, src: 3, dst: 5, direction: 3}]);

    myGraph.group([myGraph.nodes()[1], myGraph.nodes()[2]]);

    d3.select("#showBrush").on('click', myGraph.brush.show);
    d3.select("#hideBrush").on('click', myGraph.brush.hide);


    //    myGraph.group([myGraph.nodes()[2], myGraph.nodes()[4]]);
    //    myGraph.group([myGraph.nodes()[3], myGraph.nodes()[5]]);


    //myGraph.links()[0].merge();
    //console.log(myGraph.nodes()[2].getConnectedLinks());
//    var myGrid = myGraph.gridLayout().nodeSize([100, 100]).padding([70, 70]);
//    myGrid(myGraph.nodes());
    setTimeout(
            function getRemoteData() {
                myGraph.group([myGraph.nodes()[0], myGraph.nodes()[5]]);
                //myGraph.nodes()[6].ungroup();
//                var forceLayout = myGraph
//                        .forceLayout()
//                        .nodes(myGraph.nodes())
//                        .force("link", d3.forceLink(myGraph.links()).distance(200).strength(1))
//                        .force("charge", d3.forceManyBody());
//
//                for (var i = 300; i--;) {
//                    forceLayout.tick();
//                }
//                myGraph.hierarchyLayout(myGraph.nodes(), myGraph.links(), 1500, 500);
//                myGraph.render();

//        $.getJSON('http://localhost/magneto_api/g3.php/nodes')
//                .then(function(data){
//                    myGraph.nodes(data.nodes)
//                            .links(data.links);
//                });
            }, 500);
    //
    //    setTimeout(function () {
    //        myGraph.links()[7].unmerge();
    //    }, 2000);
    //    setTimeout(function(){
    //        myGraph.links()[0].label("updateed");
    //    },2000);
    //
    //    setTimeout(function(){
    //        graph.nodes({id: 7, label: "G", x: 80, y:170});
    //        graph.links({id: 99, label: "A->D", src: 2, dst: 4,direction: 0});
    //        nodes[3]['label'] = "changedD";
    //    }, 1000);
    //
    //    setTimeout(function(){
    //        //graph.removeNodes(nodes[0]);
    //        //graph.removeLinks(links[0]);
    //        myGraph._getSvgSelection().call(myGraph.zoom.transform, d3.zoomIdentity.scale(2.2));
    //    }, 1500);


    //
    //    var graph2 = g3.graph("#my-svg2")
    //            .width(300)
    //            .height(300)
    //            .nodes(nodes)
    //            .links(links);
    //
    //    graph2.render();


</script>